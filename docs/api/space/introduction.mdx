---
sidebar_position: 1
custom_edit_url: null
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# üåå What is SPACE?

**Subscription and Pricing Access Control Engine (SPACE)** is a pricing-driven self-adaptation solution. üöÄ This means that its primary objective is to enable services to dynamically adjust their behavior based on the pricing model and contractual agreements of each user. In practice, this ensures that users can only access the features included in their subscription and are restricted according to the usage limits defined in their contracts.

## üéØ Scope

SPACE is designed to handle two main types of changes that can occur in a SaaS environment:

- üìú Contract changes (also know as _novations_ in legal terms)
- üí∞ Pricing updates (plan additions, plan removals, usage limits updates, etc...)

:::info What are contract novations?

The word _novate_ means to replace an old obligation with a new one [^1]. In the context of SaaS, a novation occurs when the customer and the provider renegotiate the terms of the contract. For example, this happens when a customer upgrades from a free subscription to a paid plan in a higher tier, gaining access to new features and extended usage limits.

:::

## üß© Overview

Like other SPHERE pricing-driven self-adaptation solutions, SPACE leverages [iPricings](../core-concepts/iPricing.md) to orchestrate both contracts and variability. Its distinctive contribution lies in the fact that, unlike previous approaches, SPACE does not require the host application‚Äîi.e., the service integrating the solution‚Äîto embed a dedicated subscription management module. This represents a major architectural shift: **SPACE can be scaled and deployed independently from managed service(s).** Consequently, the host application only needs to interact with SPACE through its **REST API** to query the current subscription state of a user, evaluate feature toggles, and enforce access control.

:::info ü§î Why externalizing subscription state?

Experience has shown that embedding subscription state logic directly into the managed application introduces significant complexity and long-term maintenance overhead [^2]. Each new plan or add-on further increases the difficulty of managing subscription states in a scalable manner. SPACE addresses these challenges by offloading subscription management to a dedicated external service that centralizes all data required for pricing-driven self-adaptation, thus improving performance and enabling seamless integration across heterogeneous environments.

| ‚úÖ Advantages                                                                      | ‚ö†Ô∏è Potential Disadvantages                                                                |
| ---------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **Decouples** subscription management from the managed system‚Äôs technology stack       | Introduce network latency                                                               |
| Provides **centralized role-based permissions** management                             | Requires integration of SPACE‚Äôs subscription module into the authentication workflow    |
| **Improves feature evaluation performance** through caching mechanisms                 | Learning curve for teams adopting SPACE‚Äôs configuration and workflows                   |
| **Eliminates** the need for developers to implement and maintain subscription logic    |                                                                                         |
| Supports management of **multiple services** and instances simultaneously              |                                                                                         |
| Offers a **dedicated UI** for managing pricing versions and permissions                |                                                                                         |

:::

:::warning Important Note

Before diving into the details of SPACE, it‚Äôs important to remember the following concepts (this is a quick reminder from the [core concepts](../core-concepts/terminology.md) section):

- **Managed Application**: This application relies on SPACE to manage user subscriptions, evaluate feature access, and enforce usage limits based on the defined pricing models.

- **Service**: a distinct component or microservice within the managed application that interacts with SPACE. Each service can have its own pricing model and subscription requirements.

- **Feature**: defined in the pricing and may have associated usage limits.

- **Usage Limit:** additional constraints to further restrict feature access and usage.

- **Pricings** are versioned and managed within SPACE.

- **Subscription**: Represents the choice of a user for a given plan and, optionally, a set of add-ons.

- **Configuration**: It is the combination of features and usage limits that results from a user‚Äôs subscription within a specific pricing version.

- **Usage level:** It is tracked by SPACE to decide whether usage limits have been reached.

- **Subscription State:** The current status of a user‚Äôs subscription, including the active plan, add-ons, and usage levels. SPACE keeps this synchronized to ensure consistent access control.
:::

## üåê SaaS Providers with Multiple Services

One of the key advantages of **SPACE** over traditional subscription management solutions is its ability to support **pooled subscriptions** ‚Äîthat is, a single subscription that spans across multiple services.  

Why does this matter?  
- SaaS providers often start with a single service and progressively add new features as add-ons or higher-tier plans.  
- Over time, to reduce cognitive overload for users, providers may **split features into separate services**, each with its own pricing model.  
- With SPACE, you don‚Äôt need to manage these subscriptions separately ‚Äîthey can all live under one unified subscription context.  

This flexibility is powered by the [iSubscription model](../core-concepts/iSubscription.md), which allows a single subscription to include multiple services, each with its own plan and optional add-ons.

Here‚Äôs a simplified view of the iSubscription metamodel:

```mermaid
classDiagram
    Subscription "1" -- "1..*" Service : includes
    Service *-- "0..1" Plan
    Service *-- "0..*" AddOn
```
<Tabs defaultValue="single-service">
  <TabItem value="single-service" label="Single Service Subscription">

For example, Overleaf is a cloud LaTeX editor.
A user might subscribe to the Standard plan and also purchase the AI Assist add-on:

```mermaid
classDiagram
    class Sub["<u>Single: Subscription</u>"]
    class Overleaf["<u>Overleaf: Service</u>"]

    class Plan["<u>Standard: Plan</u>"]
    class AddOn["<u>AI Assist: AddOn</u>"]

    Sub -- Overleaf
    Overleaf -- Plan
    Overleaf -- AddOn
```

  </TabItem>
  <TabItem value="multi-service" label="Multiple Service Subscription" default>

Now consider Cake.com, which offers multiple products:

- **Plaky:** project management
- **Pumble:** team communication
- **Clockify:** time tracking

With SPACE, a single subscription can include plans for each of these services simultaneously:

```mermaid
---
title:  A subscription with Plaky FREE, Pumble PRO and Clockify STANDARD
---
classDiagram
    class Sub["<u>Multi: Subscription</u>"]
    class Plaky["<u>Plaky: Service</u>"]
    class Pumble["<u>Pumble: Service</u>"]
    class Clockify["<u>Clockify: Service</u>"]
        
    class PlakyPlan["<u>Plaky FREE: Plan</u>"]
    class PumblePlan["<u>Pumble PRO: Plan</u>"]
    class ClockifyPlan["<u>Clockify STANDARD: Plan</u>"]
        
    Sub -- Plaky
    Plaky -- PlakyPlan
    Sub -- Pumble
    Pumble -- PumblePlan
    Clockify -- ClockifyPlan
    Sub -- Clockify
```
  </TabItem>
</Tabs>

## üèõÔ∏è Architecture

The first major architectural difference with [Pricing4SaaS](../Pricing4SaaS/understanding/architecture.md) lies in the "_subscription manager_", which is now fully decoupled from the managed service. This allows SPACE to centralize all the data required for pricing-driven self-adaptation ‚Äìi.e. pricings and subscription states‚Äì, thus improving performance. The second key difference concerns deployment: SPACE is designed as a standalone, on-premises, API-based component, which enables its integration into any environment and overcomes the monolithic limitations of Pricing4SaaS. Despite this shift, SPACE retains compatibility with existing toggling workflows by preserving feature flags as the variation points where feature access is evaluated ‚Äìjust as in Pricing4SaaS.

Beyond addressing the architectural limitations of the state of the art, SPACE also introduces several additional advantages:

1. üåç It is agnostic to the technology stack of the managed system.
2. üìÇ It can act as a pricing version control system due to its built-in MongoDB database.
3. ‚ö° It supports caching mechanisms to accelerate feature evaluations. Moreover, to further streamline integration and minimize boilerplate code, SPACE provides dedicated SDKs that encapsulate API interactions behind native methods tailored for managed applications (see SDKs section for more information).

![SPACE Architecture](../../static/img/space/architecture.png)

Regarding its architecture (see image above), SPACE exposes four interfaces:

1. üßæ The **Subscription Manager** interface (1) allows CRUD of user subscription ‚Äìincluding retrieval and auto-management of subscription states.
2. üíπ The **Pricing Management** interface (2) maintains validated versions of each service‚Äôs pricing. In large-scale SaaS ecosystems, where multiple services may coexist (e.g., GitHub and GitHub Copilot), distinct pricings per service can be managed through this interface.
3. üîê The **Access Control Management** interface (3) controls access to SPACE‚Äôs operations, allowing restrictions to be set on which actors can perform specific actions.
4. üéõÔ∏è The **Feature Evaluation** interface (4) supports two complementary uses. By sending just a user ID, it issues a JSON Web Token (JWT) encoding the user‚Äôs subscription state and a summary of their feature access permissions. These tokens are consumed by SPACE‚Äôs frontend clients to keep the UI consistent with the subscription. If both a user ID and a feature ID are sent, the interface evaluates whether the user has access to the indicated feature ‚Äìreturning a boolean result without issuing a JWT‚Äì nonetheless, this operation is intended for backend clients. No matter the use, evaluations always require information retrieved by interfaces (1) and (2).

## üîó Communication Strategy Overview

**SPACE** uses **JSON Web Tokens (JWTs)** to transmit the results of pricing features evaluations from the server to the client. Along with the evaluation results, these tokens also encode both subscription and pricing information for the requesting user.

On the client side, SPACE expects the JWT to be stored in the browser‚Äôs local storage as a `String` under the key `pricingToken`. **Therefore, SPACE's client SDKs rely on this token to resolve feature access and enforce usage limits.**

![SPACE Communication Strategy](../../static/img/space/communication.png)

:::tip üõ°Ô∏è Deployment and Security Best Practices

For security reasons, **SPACE should always be deployed on the server side** and remain inaccessible from the public internet. This ensures that sensitive operations ‚Äìsuch as subscription management, feature evaluations, and token generation‚Äì are executed in a trusted environment, preventing exposure of internal APIs and secret keys.

Although technically possible, exposing a SPACE instance directly to the internet or allowing client-side applications to communicate with it bypasses these safeguards and increases the attack surface. Instead, the recommended approach is to restrict access to SPACE to backend services only, and let client-side applications to perform toggling exclusively through tokens securely issued by the server.

:::

### üîë Token Structure

A typical pricing token has the following structure:

**SPACE** relies on JSON Web Tokens (JWT) to send from the server side the evaluation results of different pricing features for the user that makes the request. In order to be used by SPACE clients, the JWT must be stored as a `String` in the local storage of the browser, with the name `pricingToken`. 

The body of such token must have the following structure:

```
{
  "sub": String,
  "exp": timestamp,
  "iat": timestamp,
  "features": {
    "feature1": {
      "eval": boolean|string,
      "used": int,
      "limit": int
    },
    "feature2": {
      "eval": boolean|string,
      "used": int|null,
      "limit": int|null
    }
  },
  "subscriptionContext": { ... },
  "pricingContext": { ... }
}
```

### üìã Field Description

- **Standard JWT claims:**
  - `sub`: Subject (the user identifier)
  - `exp`: Expiration time
  - `iat`: Issued-at timestamp

- **Custom claims added by SPACE:**
  - `features`: Contains the evaluation results for pricing features.
    - `eval`: A `boolean` indicating whether the user has access to the feature.
    - `used`: Current `usage level` for the feature (e.g., 3 predictions made). This field can be `null` if not applicable (e.g. because the feature is not linked to a usage limit).
    - `limit`: Maximum allowed usage for the feature (e.g., 10 predictions). Usually the value of the usage limit linked to the feature in the user's configuration.
      - If `used` and `limit` are set to null, the feature is considered unlimited (not bound by usage restrictions).
  - `subscriptionContext`: Optional object holding user-specific usage levels.
  - `pricingContext`: Optional object holding user's configuration details.

Both `subscriptionContext` and `pricingContext` are intended for client-side rendering of pricing information. If absent, they default to empty objects.

:::info üîÑ Token Lifecycle
You don‚Äôt need to handle JWT generation manually. SPACE automatically issues pricing tokens when requested.
:::

:::warning Client-Side Token Handling
All SPACE SDKs are designed with a server-issued token workflow:

- **Server-side SDKs** provide methods to generate pricing tokens securely.
- **Client-side SDKs** only offer methods to retrieve and update the token from local storage, and to evaluate feature access (e.g., rendering or hiding UI components).

**Generating tokens on the client side is strongly discouraged**, as it would require embedding sensitive information (e.g., secret keys) into the client application. This creates a security risk, since such keys could be extracted and misused.

‚û°Ô∏è Always generate tokens in a secure server-side environment and deliver them to the client through controlled channels.
:::

## üßë‚Äçüíª Tech Stack

<div align="center">

| Frontend         | Backend         | Tooling & DevOps      | Other                |
|------------------|----------------|-----------------------|----------------------|
| ![React](https://img.shields.io/badge/-React-61DAFB?logo=react&logoColor=white&style=for-the-badge) | ![Express](https://img.shields.io/badge/-Express-000?logo=express&logoColor=white&style=for-the-badge) | ![Docker](https://img.shields.io/badge/-Docker-2496ED?logo=docker&logoColor=white&style=for-the-badge) | ![TypeScript](https://img.shields.io/badge/-TypeScript-3178C6?logo=typescript&logoColor=white&style=for-the-badge) |
| ![Vite](https://img.shields.io/badge/-Vite-646CFF?logo=vite&logoColor=white&style=for-the-badge) | ![Node.js](https://img.shields.io/badge/-Node.js-339933?logo=node.js&logoColor=white&style=for-the-badge) | ![pnpm](https://img.shields.io/badge/-pnpm-F69220?logo=pnpm&logoColor=white&style=for-the-badge) | ![TailwindCSS](https://img.shields.io/badge/-TailwindCSS-06B6D4?logo=tailwindcss&logoColor=white&style=for-the-badge) |
| ![Framer Motion](https://img.shields.io/badge/-Framer%20Motion-EF008F?logo=framer&logoColor=white&style=for-the-badge) | ![Helmet](https://img.shields.io/badge/-Helmet-000?logo=helmet&logoColor=white&style=for-the-badge) | ![ESLint](https://img.shields.io/badge/-ESLint-4B32C3?logo=eslint&logoColor=white&style=for-the-badge) | ![Prettier](https://img.shields.io/badge/-Prettier-F7B93E?logo=prettier&logoColor=white&style=for-the-badge) |

</div>

## ‚ö†Ô∏è Disclaimer & License

### LICENSE

This project is licensed under the MIT License. See [LICENSE](https://github.com/Alex-GF/space/blob/main/LICENSE) for details

### DISCLAIMER

This tool is part of ongoing research by the [ISA group](https://github.com/isa-group) in pricing-driven development and operation of SaaS. It is in a **very early stage** and is not intended for production use. The ISA group does not accept responsibility for any issues or damages that may arise from its use in real-world environments

[^1]:
    Hollenbeck, S. 2025-02-17. Novation Agreement Process: Step-by-Step Guide
    for Businesses. Retrieved from
    https://www.lexology.com/library/detail.aspx?g=77e34291-8595-4d73-9f1c-777db936ae17

[^2]: 
    Garc√≠a-Fern√°ndez, A., Parejo, J. A., & Ruiz-Cort√©s, A. (2025). iSubscription: Bridging the Gap Between Contracts and Runtime Access Control in SaaS. In: International Conference on Service-Oriented Computing.